{
    "moduleid" : "shape2sas"
    ,"label"    : "Shape2SAS"
    ,"executable"   : "shape2sas.py"
    ,"submitpolicy" : "all"
#    ,"uniquedir" : "true"
#    ,"center" : "true"
    ,"centeroutput" : "true"
# dependencies:
# apt-get install libgfortran3 libpng-dev libreadline-dev
    ,"fields"   : [
        {
#            "role"       : "input"
#            ,"id"        : "label_0"
#            ,"type"      : "label"
#            ,"colspan"   : 17
#            ,"default"   : "header3"
            #,"label"     : "<hr>Shape2SAS [<a target=_blank href=https://doi.org/10.1107/S1600576714013156>1, </a><a target=_blank href=http://scripts.iucr.org/cgi-bin/paper?S0021889890002801>2, </a><a target=_blank href=https://github.com/ehb54/GenApp-Shape2SAS>Source code</a>]"
#            ,"label"     : "<hr>Shape2SAS [<a target=_blank href=https://arxiv.org/abs/2301.04976>Preprint, </a><a target=_blank href=https://github.com/ehb54/GenApp-Shape2SAS>Source code</a>]"
#            ,"prehline"  : "true"
#            ,"posthline" : "true"
#        }
#        ,{
            "role"       : "input"
            ,"id"         : "description_program"
#            ,"label"      : "<p>Shape2SAS [<a target=_blank href=https://doi.org/10.1107/S1600576714013156>1, </a><a target=_blank href=http://scripts.iucr.org/cgi-bin/paper?S0021889890002801>2, </a><a target=_blank href=https://github.com/ehb54/GenApp-Shape2SAS>Source code</a>] calculates the small-angle scattering (SAS) and pair distribution from a particle (model), which shape is defined by the user.</p><p> Particles can be build up by combining subunits, e.g., a dumbbell can be generated by combining two spheres and a cylinder.</p><p>How to use:</p><ul><li>Build a particle (model) out of one or more subunits (default: a 50 &Aring; sphere). </li><li>For multicontrast particles, built it using subunits with different contrasts (&Delta;SLD).</li><li>In case of overlap, points from the subunits further down the list are removed (this can be deselected, but be aware then of the effective &Delta;SLD, which may differ from the input value).</li><li>Optionally, generate additional model(s) for comparison (e.g., particles with various shapes or particles with/without polydispersity).</li><li>Hover the mouse over the fields for a short descripton.</li></ul><p>Enjoy! Feedback welcome via the tab to the right.</p><hr>"
            ,"label"      : "<p>Shape2SAS [<a target=_blank href=https://arxiv.org/abs/2301.04976>preprint, </a><a target=_blank href=https://github.com/ehb54/GenApp-Shape2SAS>Source code</a>] calculates the small-angle scattering (SAS) and pair distribution from a particle (model), which shape is defined by the user.</p><p> Particles can be build up by combining subunits, e.g., a dumbbell can be generated by combining two spheres and a cylinder.</p><p>How to use:</p><ul><li>Build a particle (model) out of one or more subunits (default: a 50 &Aring; sphere). </li><li>For multicontrast particles, built it using subunits with different contrasts (&Delta;SLD).</li><li>In case of overlap, points from the subunits further down the list are removed (this can be deselected, but be aware then of the effective &Delta;SLD, which may differ from the input value).</li><li>Optionally, generate additional model(s) for comparison (e.g., particles with various shapes or particles with/without polydispersity).</li><li>Hover the mouse over the fields for a short descripton.</li></ul><p>Enjoy! Feedback welcome via the tab to the right.</p><hr>"
            ,"type"       : "label"
            ,"colspan"    : 17
        }
        ,{
            "role"       : "input"
            ,"id"         : "qmin"
            ,"label"      : "q min [1/&Aring;]"
            ,"type"       : "float"
            ,"step"       : 0.01
	    ,"default"    : 0.001
	    ,"min"        : 0.0
	    ,"max"        : 10000
            ,"help"       : "q min, in inverse Angstroms"
        }
        ,{
            "role"       : "input"
            ,"id"         : "qmax"
            ,"label"      : "q max [1/&Aring;]"
            ,"type"       : "float"
            ,"step"       : 0.01
	    ,"default"    : 0.5
            ,"min"        : 0.0
            ,"max"        : 2.5
            ,"help"       : "q max, in inverse Angstrom"
        }
        ,{
            "role"       : "input"
            ,"id"         : "qpoints"
            ,"label"      : "Number of points in q"
            ,"type"       : "integer"
            ,"min"        : 10
            ,"default"    : 400
            ,"max"        : 2000
            ,"help"       : "<p>Number of points in q.</p><p>Minimum 10, Maximum 2000</p>"
        }
#	,{
#            "role"       : "input"
#            ,"id"         : "noise"
#            ,"label"      : "Relative noise"
#            ,"type"       : "float"
#            ,"step"       : 0.01
#            ,"default"    : 1
#            ,"min"        : 0.0001
#            ,"max"        : 10000
#            ,"help"       : "<p>Relative noise on simulated data.</p><p>Min: 0.0001, max: 10000.</p><p> the error is simulated using: sigma = noise*sqrt[(5E6+I)/(0.05*q)], where I,q are calculated from p(r)</p><p>Sedlak, Bruetzel and Lipfert (2017). J. Appl. Cryst. 50, 621-30. Quantitative evaluation of statistical errors in small- angle X-ray scattering measurements (https://doi.org/10.1107/S1600576717003077)</p>"
#        }
	,{
            "role"       : "input"
            ,"id"         : "exposure"
            ,"label"      : "Relative exposure time [a.u.]"
            ,"type"       : "float"
            ,"step"       : 0.5
            ,"default"    : 500
            ,"min"        : 0.0001
            ,"max"        : 1000000
            ,"help"       : "<p>Exposure time, in arbitrary units. </p><p>The exposure time is normalised out in the simulated intensity, but it will affect the noise level of data.</p><p>Typical values when using default model parameters: synchrotron SAXS: 100-500, home-source SAXS: 10-50, SANS: unknown, this has not been estimated.</p><p>Error model: Sedlak, Bruetzel and Lipfert (2017). J. Appl. Cryst. 50, 621-30. Quantitative evaluation of statistical errors in small- angle X-ray scattering measurements (https://doi.org/10.1107/S1600576717003077)</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "prpoints"
            ,"label"      : "Number of points in p(r)"
            ,"type"       : "integer"
            ,"min"        : 10
            ,"default"    : 100
            ,"max"        : 200
            ,"help"       : "<p>Number of points in the pair distance distribution, p(r).</p><p>Default: 100, Minimum 10, Maximum 200</p>"
        }
	,{
            "role"       : "input"
            ,"id"         : "Npoints"
            ,"label"      : "Number of simulated points"
            ,"type"       : "integer"
            ,"min"        : 2000
            ,"default"    : 3000
            ,"max"        : 50000
            ,"help"       : "<p>Max number of points in each simulated model.</p><p>Increase for more precision at high q (longer computational time).</p><p>Default: 3000, Minimum 2000, Maximum 30000</p><p>If the number of points exceeds 10,000 then multiple p(r) are calculated and their mean values are used for intensity calculations. This is for computational efficiency, as the calculations goes as NxN.</p>"
        }
#################################################################################################################
## MODEL 1 ######################################################################################################
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "include_model_1"
            ,"label"      : "<hr> Calculate scattering for Model 1"
            ,"type"       : "checkbox"
            ,"checked"    : "true"
            ,"help"       : "<p>Calculate scattering for Model 1.</p>"
#            ,"colspan"    : 17
            ,"repeater"   : "true"
            ,"hider"      : "true"
        }
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "name_1"
            ,"label"      : "Name of Model 1"
            ,"type"       : "text"
            ,"default"    : "Name 1"
            ,"size"       : 17
            ,"help"       : "<p>Name of Model 1 </p><p>The model consists of one or more subunits</p></p><p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"
	    ,"repeat"     : "include_model_1"
        }
	,{
            "role"       : "input"
            ,"id"         : "exclude_overlap_1"
            ,"label"      : "Exclude overlap regions"
            ,"type"       : "checkbox"
            ,"checked"    : "true"
            ,"help"       : "<p>Exclude overlap regions.</p><p>If there is overlap with subunits higher up in the list, the points in the overlap region will be omitted.</p>"
            ,"repeat"     : "include_model_1"
        }
	,{
            "role"       : "input"
            ,"id"         : "subunit_count_1"
            ,"label"      : "Number of subunits"
            ,"type"       : "integer"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 15
            ,"help"       : "Enter the number of subunits, up to 15. Increasing the number of points for complex shapes."
	    ,"tableize"   : "true"
	    ,"repeat"     : "include_model_1"
	    ,"repeater"   : "true"
        }
#################################################################################################################       
        ,{"role": "input","id": "subunit_type_1","label": "&nbsp;subunit type","type": "listbox","values": "Sphere~sphere~Ellipsoid (Tri-axial)~ellipsoid~Cylinder~cylinder~Disc~disc~Cube~cube~Cuboid~cuboid~Hollow sphere~hollow_sphere~Hollow cube~hollow_cube~Cylindrical ring~cyl_ring~Discoidal ring~disc_ring","norow": "true","size": 30,"default": "sphere","repeat": "subunit_count_1","help": "<p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"}
        ,{"role": "input","id": "a_1","label": "&nbsp;a","type": "float","min": "0","max": "9999999","default": 50,"norow": "true","required" : "true","repeat": "subunit_count_1","help": "<p>Subunit dimension a</p><p>Sphere: radius</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: side length</p><p>Cuboid: width</p><p>Hollow sphere: outer radius</p><p>Hollow cube: outer side length</p><p>Cylindrical/discoidal ring: outer radius </p>"}
        ,{"role": "input","id": "b_1","label": "&nbsp;b ","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_1","help": "<p>Subunit dimension b</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: no effect</p><p>Cuboid: depth</p><p>Hollow sphere: inner radius</p><p>Hollow cube: inner side length</p><p>Cylindrical/discoidal ring: inner radius </p>"}
        ,{"role": "input","id": "c_1","label": "&nbsp;c","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_1","help": "<p>Subunit dimension c</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: length</p><p>Cube: no effect</p><p>Cuboid: height</p><p>Hollow sphere: no effect </p><p>Hollow cube: no effect</p><p>Cylindrical/discoidal ring: length </p>"}
        ,{"role": "input","id": "p_1","label": "&nbsp;&Delta;SLD","type": "float","min": "-999999","max": "9999999","default": 1,"norow": "true","repeat": "subunit_count_1","help": "Excess scattering length density (contrast) of subunit"}
        ,{"role": "input","id": "x_1","label": "&nbsp;x_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_1","help": "center of mass x position of subunit"}
        ,{"role": "input","id": "y_1","label": "&nbsp;y_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_1","help": "center of mass y position of subunit"}
        ,{"role": "input","id": "z_1","label": "&nbsp;z_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_1","help": "center of mass z position of subunit"}	
#################################################################################################################        
        ,{
            "role"       : "input"
            ,"id"         : "polydispersity_1"
            ,"label"      : "Relative polydispersity"
            ,"type"       : "float"
            ,"step"       : 0.05
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 0.3
            ,"help"       : "Relative polydispersity. Min: 0.0 (monodisperse), max: 0.3."
	    ,"repeat"     : "include_model_1"
        }
	,{
            "role"       : "input"
            ,"id"         : "S_1"
            ,"label"      : "Structure factor"
            ,"type"       : "listbox"
            ,"values"     : "None~None~Hard-sphere~HS~Aggregate~Aggr"
            ,"default"    : "None"
            ,"repeater"   : "true"
            ,"help"       : "<p>Select structure factor from the list (default: None)</p><p>Hard-sphere: Hard-sphere structure factor, repulsion in concentrated samples, see Ref [1]</p><p>Aggregate: Aggregate structure factor, 2-dimensional fractal aggregates, see Ref [2]</p><p>[1] Kotlarchyk and Chen, J Chem Phys 1983: Analysis of small angle neutron scattering spectra from polydisperse interacting colloids.</p><p>[2] Larsen, Pedersen and Arleth, J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates.</p>"
	    ,"repeat"     : "include_model_1"
        }
#	,{
#            "role"       : "input"
#            ,"id"         : "eta_1"
#            ,"label"      : "Volume fraction"
#            ,"type"       : "float"
#            ,"step"       : 0.1
#            ,"default"    : 0.2
#            ,"min"        : 0.0
#            ,"max"        : 0.9
#            ,"repeat"     : "S_1:HS"
#            ,"help"       : "<p>Volume fraction in hard-sphere structure factor, S(q). For high-conc samples.</p><p>Applied to the scattering, I(q), but not to the p(r), which is for the monodisperse model.</p><p>Min: 0.0 (no structure factor), max: 0.9.</p>"
#        }
        ,{
            "role"       : "input"
            ,"id"         : "r_hs_1"
            ,"label"      : "Hard-sphere radius"
            ,"type"       : "float"
            ,"step"       : 5
            ,"default"    : 50
            ,"min"        : 0.0
            ,"max"        : 1000
            ,"repeat"     : "S_1:HS"
            ,"help"       : "<p>Hard-sphere interaction radius - for high concentration samples.</p><p> Used in hard sphere structure factor, S(q)</p><p>Min: 0.0.</p><p>Only relevant if Volume fraction > 0</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "frac_1"
            ,"label"      : "Fraction of aggregates"
            ,"type"       : "float"
            ,"step"       : 0.1
            ,"default"    : 0.1
            ,"min"        : 0.0
            ,"max"        : 1.0
            ,"repeat"     : "S_1:Aggr"
            ,"help"       : "<p>Fraction of particles that are in aggregated form. </p><p>Aggregates are assumed to form fractal aggregates, included in scattering (not in p(r)) via structure factor S2(q) from Ref:</p><p>Larsen, Pedersen and Arleth (2020). J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates</p><p>Min: 0.0 (no aggregates). Max: 1.0 (all particles are aggregated).</p>"
	}
	,{
            "role"       : "input"
            ,"id"         : "R_eff_1"
            ,"label"      : "Effective radius"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 50
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Effective radius of each particle in aggregate (not of whole aggregate). </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_1:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "N_aggr_1"
            ,"label"      : "Particles per aggregate"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 80
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Number of particles per aggregate. </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_1:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "conc_1"
            ,"label"      : "Volume fraction (conc)"
            ,"type"       : "float"
            ,"step"       : 0.02
            ,"default"    : 0.02
            ,"min"        : 0.0
            ,"max"        : 0.9
            ,"help"       : "<p>Volume fraction (concentration):</p><p>how much of the sample volume is occupied by the particles - scales the intensity and affects the noise in data.</p><p>The volume fraction also affects the scattering via the hard-sphere structure factor, if this is enabled.</p><p>Min: 0.0, max: 0.9</p>"
            ,"repeat"     : "include_model_1"
        }
	,{
            "role"       : "input"
            ,"id"         : "sigma_r_1"
            ,"label"      : "Interface roughness [&Aring;]"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 15.0
            ,"help"       : "<p>Interface roughness, for non-sharp edges between subunits. </p> See Skar-Gislinge et al, PhysChemChemPhys 2011: Small-angle scattering from phospholipid nanodiscs: derivation and refinement of a molecular constrained analytical model form factor. </p><p> Decreasing scattering at high q, by I(q) = I(q)*exp(-(q*sigma_r)^2/2)</p><p>Min: 0.0 (no roughness), max: 15.0.</p>"
            ,"repeat"     : "include_model_1"
        }
#################################################################################################################        
## MODEL 2 ######################################################################################################        
#################################################################################################################        
        ,{
            "role"       : "input"
            ,"id"         : "include_model_2"
            ,"label"      : "<hr> Calculate scattering for Model 2"
            ,"type"       : "checkbox"
            ,"checked"    : "false"
            ,"help"       : "<p>Calculate scattering for Model 2 - for comparison with other models.</p>"
            ,"colspan"    : 17
            ,"repeater"   : "true"
            ,"hider"      : "true"
        }
#################################################################################################################        
        ,{
            "role"       : "input"
            ,"id"         : "name_2"
            ,"label"      : "Name of Model 2"
            ,"type"       : "text"
            ,"default"    : "Name 2"
            ,"size"       : 17
            ,"help"       : "<p>Name of Model 2 </p><p>The model consists of one or more subunits</p></p><p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"
	    ,"repeat"     : "include_model_2"
        }
	,{
            "role"       : "input"
            ,"id"         : "exclude_overlap_2"
            ,"label"      : "Exclude overlap regions"
            ,"type"       : "checkbox"
            ,"checked"    : "true"
            ,"help"       : "<p>Exclude overlap regions.</p><p>If there is overlap with subunits higher up in the list, the points in the overlap region will be omitted.</p>"
            ,"repeat"     : "include_model_2"
        }
	,{
            "role"       : "input"
            ,"id"         : "subunit_count_2"
            ,"label"      : "Number of subunits"
            ,"type"       : "integer"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 15
            ,"help"       : "Enter the number of subunits, up to 15. Consider increasing the number of points for complex shapes."
	    ,"tableize"   : "true"
	    ,"repeat"     : "include_model_2"
	    ,"repeater"   : "true"
        }
#################################################################################################################
        ,{"role": "input","id": "subunit_type_2","label": "&nbsp;subunit type","type": "listbox","values": "Sphere~sphere~Ellipsoid (Tri-axial)~ellipsoid~Cylinder~cylinder~Disc~disc~Cube~cube~Cuboid~cuboid~Hollow sphere~hollow_sphere~Hollow cube~hollow_cube~Cylindrical ring~cyl_ring~Discoidal ring~disc_ring","norow": "true","size": 30,"default": "sphere","repeat": "subunit_count_2","help": "<p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"}
        ,{"role": "input","id": "a_2","label": "&nbsp;a","type": "float","min": "0","max": "9999999","default": 50,"norow": "true","required" : "true","repeat": "subunit_count_2","help": "<p>Subunit dimension a</p><p>Sphere: radius</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: side length</p><p>Cuboid: width</p><p>Hollow sphere: outer radius</p><p>Hollow cube: outer side length</p><p>Cylindrical/discoidal ring: outer radius </p>"}
        ,{"role": "input","id": "b_2","label": "&nbsp;b ","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_2","help": "<p>Subunit dimension b</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: no effect</p><p>Cuboid: depth</p><p>Hollow sphere: inner radius</p><p>Hollow cube: inner side length</p><p>Cylindrical/discoidal ring: inner radius </p>"}
        ,{"role": "input","id": "c_2","label": "&nbsp;c","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_2","help": "<p>Subunit dimension c</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: length</p><p>Cube: no effect</p><p>Cuboid: height</p><p>Hollow sphere: no effect </p><p>Hollow cube: no effect</p><p>Cylindrical/discoidal ring: length </p>"}
        ,{"role": "input","id": "p_2","label": "&nbsp;&Delta;SLD","type": "float","min": "-999999","max": "9999999","default": 1,"norow": "true","repeat": "subunit_count_2","help": "Excess scattering length density (contrast) of subunit"}
        ,{"role": "input","id": "x_2","label": "&nbsp;x_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_2","help": "center of mass x position of subunit"}
        ,{"role": "input","id": "y_2","label": "&nbsp;y_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_2","help": "center of mass y position of subunit"}
        ,{"role": "input","id": "z_2","label": "&nbsp;z_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_2","help": "center of mass z position of subunit"}	
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "polydispersity_2"
            ,"label"      : "Relative polydispersity"
            ,"type"       : "float"
            ,"step"       : 0.05
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 0.3
            ,"help"       : "Relative polydispersity. Min: 0.0 (monodisperse), max: 0.3."
	    ,"repeat"     : "include_model_2"
        }
	,{
            "role"       : "input"
            ,"id"         : "S_2"
            ,"label"      : "Structure factor"
            ,"type"       : "listbox"
            ,"values"     : "None~None~Hard-sphere~HS~Aggregate~Aggr"
	    ,"default"    : "None"
            ,"repeater"   : "true"
            ,"help"       : "<p>Select structure factor from the list (default: None)</p><p>Hard-sphere: Hard-sphere structure factor, repulsion in concentrated samples, see Ref [1]</p><p>Aggregate: Aggregate structure factor, 2-dimensional fractal aggregates, see Ref [2]</p><p>[1] Kotlarchyk and Chen, J Chem Phys 1983: Analysis of small angle neutron scattering spectra from polydisperse interacting colloids.</p><p>[2] Larsen, Pedersen and Arleth, J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates.</p>"
	    ,"repeat"     : "include_model_2"
        }
#	,{
#            "role"       : "input"
#            ,"id"         : "eta_2"
#            ,"label"      : "Volume fraction"
#            ,"type"       : "float"
#            ,"step"       : 0.1
#            ,"default"    : 0.2
#            ,"min"        : 0.0
#            ,"max"        : 0.9
#	    ,"repeat"     : "S_2:HS"
#            ,"help"       : "<p>Volume fraction in hard-sphere structure factor, S(q). For high-conc samples.</p><p>Applied to the scattering, I(q), but not to the p(r), which is for the monodisperse model.</p><p>Min: 0.0 (no structure factor), max: 0.9.</p>"
#        }
        ,{
            "role"       : "input"
            ,"id"         : "r_hs_2"
            ,"label"      : "Hard-sphere radius"
            ,"type"       : "float"
            ,"step"       : 5
            ,"default"    : 50
            ,"min"        : 0.0
	    ,"max"        : 1000
	    ,"repeat"     : "S_2:HS"
            ,"help"       : "<p>Hard-sphere interaction radius - for high concentration samples.</p><p> Used in hard sphere structure factor, S(q)</p><p>Min: 0.0.</p><p>Only relevant if Volume fraction > 0</p>"
        }
	,{
            "role"       : "input"
            ,"id"         : "frac_2"
            ,"label"      : "Fraction of aggregates"
            ,"type"       : "float"
            ,"step"       : 0.1
            ,"default"    : 0.1
            ,"min"        : 0.0
	    ,"max"        : 1.0
	    ,"repeat"     : "S_2:Aggr"
            ,"help"       : "<p>Fraction of particles that are in aggregated form. </p><p>Aggregates are assumed to form fractal aggregates, included in scattering (not in p(r)) via structure factor S2(q) from Ref:</p><p>Larsen, Pedersen and Arleth (2020). J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates</p><p>Min: 0.0 (no aggregates). Max: 1.0 (all particles are aggregated).</p>"
	}
        ,{ 
            "role"       : "input"
            ,"id"         : "R_eff_2"
            ,"label"      : "Effective radius"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 50
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Effective radius of each particle in aggregate (not of whole aggregate). </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_2:Aggr"
        }
	,{
            "role"       : "input"
            ,"id"         : "N_aggr_2"
            ,"label"      : "Particles per aggregate"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 80
            ,"min"        : 0
	    ,"max"        : 1000
            ,"help"       : "<p>Number of particles per aggregate. </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
	    ,"repeat"     : "S_2:Aggr"
        }
	,{
            "role"       : "input"
            ,"id"         : "conc_2"
            ,"label"      : "Volume fraction (conc)"
            ,"type"       : "float"
            ,"step"       : 0.02
            ,"default"    : 0.02
            ,"min"        : 0.0
            ,"max"        : 0.9
            ,"help"       : "<p>Volume fraction (concentration):</p><p>how much of the sample volume is occupied by the particles - scales the intensity and affects the noise in data.</p><p>The volume fraction also affects the scattering via the hard-sphere structure factor, if this is enabled.</p><p>Min: 0.0, max: 0.9</p>"
            ,"repeat"     : "include_model_2"
        }
	,{
            "role"       : "input"
            ,"id"         : "sigma_r_2"
            ,"label"      : "Interface roughness [&Aring;]"
            ,"type"       : "float"
            ,"size"       : 40
            ,"step"       : 1
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 15.0
            ,"help"       : "<p>Interface roughness, for non-sharp edges between subunits. </p> See Skar-Gislinge et al, PhysChemChemPhys 2011: Small-angle scattering from phospholipid nanodiscs: derivation and refinement of a molecular constrained analytical model form factor. </p><p> Decreasing scattering at high q, by I(q) = I(q)*exp(-(q*sigma_r)^2/2)</p><p>Min: 0.0 (no roughness), max: 15.0</p>"
            ,"repeat"     : "include_model_2"
        }
#################################################################################################################
## MODEL 3 ######################################################################################################
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "include_model_3"
            ,"label"      : "<hr> Calculate scattering for Model 3"
            ,"type"       : "checkbox"
            ,"checked"    : "false"
            ,"help"       : "<p>Calculate scattering for Model 3 - for comparison with other models.</p>"
            ,"colspan"    : 17
            ,"repeater"   : "true"
            ,"hider"      : "true"
        }
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "name_3"
            ,"label"      : "Name of Model 3"
            ,"type"       : "text"
            ,"default"    : "Name 3"
            ,"size"       : 17
            ,"help"       : "<p>Name of Model 3 </p><p>The model consists of one or more subunits</p></p><p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"
	    ,"repeat"     : "include_model_3"
        }
	,{
            "role"       : "input"
            ,"id"         : "exclude_overlap_3"
            ,"label"      : "Exclude overlap regions"
            ,"type"       : "checkbox"
            ,"checked"    : "true"
            ,"help"       : "<p>Exclude overlap regions.</p><p>If there is overlap with subunits higher up in the list, the points in the overlap region will be omitted.</p>"
            ,"repeat"     : "include_model_3"
        }
	,{
            "role"       : "input"
            ,"id"         : "subunit_count_3"
            ,"label"      : "Number of subunits"
            ,"type"       : "integer"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 15
            ,"help"       : "Enter the number of subunits, up to 15. Consider increasing the number of points for complex shapes."
	    ,"tableize"   : "true"
	    ,"repeat"     : "include_model_3"
	    ,"repeater"   : "true"
        }
#################################################################################################################
        ,{"role": "input","id": "subunit_type_3","label": "&nbsp;subunit type","type": "listbox","values": "Sphere~sphere~Ellipsoid (Tri-axial)~ellipsoid~Cylinder~cylinder~Disc~disc~Cube~cube~Cuboid~cuboid~Hollow sphere~hollow_sphere~Hollow cube~hollow_cube~Cylindrical ring~cyl_ring~Discoidal ring~disc_ring","norow": "true","size": 30,"default": "sphere","repeat": "subunit_count_3","help": "<p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"}
        ,{"role": "input","id": "a_3","label": "&nbsp;a","type": "float","min": "0","max": "9999999","default": 50,"norow": "true","required" : "true","repeat": "subunit_count_3","help": "<p>Subunit dimension a</p><p>Sphere: radius</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: side length</p><p>Cuboid: width</p><p>Hollow sphere: outer radius</p><p>Hollow cube: outer side length</p><p>Cylindrical/discoidal ring: outer radius </p>"}
        ,{"role": "input","id": "b_3","label": "&nbsp;b ","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_3","help": "<p>Subunit dimension b</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: no effect</p><p>Cuboid: depth</p><p>Hollow sphere: inner radius</p><p>Hollow cube: inner side length</p><p>Cylindrical/discoidal ring: inner radius </p>"}
        ,{"role": "input","id": "c_3","label": "&nbsp;c","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_3","help": "<p>Subunit dimension c</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: length</p><p>Cube: no effect</p><p>Cuboid: height</p><p>Hollow sphere: no effect </p><p>Hollow cube: no effect</p><p>Cylindrical/discoidal ring: length </p>"}
        ,{"role": "input","id": "p_3","label": "&nbsp;&Delta;SLD","type": "float","min": "-999999","max": "9999999","default": 1,"norow": "true","repeat": "subunit_count_3","help": "Excess scattering length density (contrast) of subunit"}
        ,{"role": "input","id": "x_3","label": "&nbsp;x_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_3","help": "center of mass x position of subunit"}
        ,{"role": "input","id": "y_3","label": "&nbsp;y_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_3","help": "center of mass y position of subunit"}
        ,{"role": "input","id": "z_3","label": "&nbsp;z_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_3","help": "center of mass z position of subunit"}	
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "polydispersity_3"
            ,"label"      : "Relative polydispersity"
            ,"type"       : "float"
            ,"step"       : 0.05
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 0.3
            ,"help"       : "Relative polydispersity. Min: 0.0 (monodisperse), max: 0.3."
            ,"repeat"     : "include_model_3"
        }
        ,{
            "role"       : "input"
            ,"id"         : "S_3"
            ,"label"      : "Structure factor"
            ,"type"       : "listbox"
            ,"values"     : "None~None~Hard-sphere~HS~Aggregate~Aggr"
            ,"default"    : "None"
            ,"repeater"   : "true"
            ,"help"       : "<p>Select structure factor from the list (default: None)</p><p>Hard-sphere: Hard-sphere structure factor, repulsion in concentrated samples, see Ref [1]</p><p>Aggregate: Aggregate structure factor, 2-dimensional fractal aggregates, see Ref [2]</p><p>[1] Kotlarchyk and Chen, J Chem Phys 1983: Analysis of small angle neutron scattering spectra from polydisperse interacting colloids.</p><p>[2] Larsen, Pedersen and Arleth, J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates.</p>"
            ,"repeat"     : "include_model_3"
        }
#        ,{
#            "role"       : "input"
#            ,"id"         : "eta_3"
#            ,"label"      : "Volume fraction"
#            ,"type"       : "float"
#            ,"step"       : 0.1
#            ,"default"    : 0.2
#            ,"min"        : 0.0
#            ,"max"        : 0.9
#            ,"repeat"     : "S_3:HS"
#            ,"help"       : "<p>Volume fraction in hard-sphere structure factor, S(q). For high-conc samples.</p><p>Applied to the scattering, I(q), but not to the p(r), which is for the monodisperse model.</p><p>Min: 0.0 (no structure factor), max: 0.9.</p>"
#        }
        ,{
            "role"       : "input"
            ,"id"         : "r_hs_3"
            ,"label"      : "Hard-sphere radius"
            ,"type"       : "float"
            ,"step"       : 5
            ,"default"    : 50
            ,"min"        : 0.0
            ,"max"        : 1000
            ,"repeat"     : "S_3:HS"
            ,"help"       : "<p>Hard-sphere interaction radius - for high concentration samples.</p><p> Used in hard sphere structure factor, S(q)</p><p>Min: 0.0.</p><p>Only relevant if Volume fraction > 0</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "frac_3"
            ,"label"      : "Fraction of aggregates"
            ,"type"       : "float"
            ,"step"       : 0.1
            ,"default"    : 0.1
            ,"min"        : 0.0
            ,"max"        : 1.0
            ,"repeat"     : "S_3:Aggr"
            ,"help"       : "<p>Fraction of particles that are in aggregated form. </p><p>Aggregates are assumed to form fractal aggregates, included in scattering (not in p(r)) via structure factor S2(q) from Ref:</p><p>Larsen, Pedersen and Arleth (2020). J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates</p><p>Min: 0.0 (no aggregates). Max: 1.0 (all particles are aggregated).</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "R_eff_3"
            ,"label"      : "Effective radius"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 50
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Effective radius of each particle in aggregate (not of whole aggregate). </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_3:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "N_aggr_3"
            ,"label"      : "Particles per aggregate"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 80
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Number of particles per aggregate. </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_3:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "conc_3"
            ,"label"      : "Volume fraction (conc)"
            ,"type"       : "float"
            ,"step"       : 0.02
            ,"default"    : 0.02
            ,"min"        : 0.0
            ,"max"        : 0.9
            ,"help"       : "<p>Volume fraction (concentration):</p><p>how much of the sample volume is occupied by the particles - scales the intensity and affects the noise in data.</p><p>The volume fraction also affects the scattering via the hard-sphere structure factor, if this is enabled.</p><p>Min: 0.0, max: 0.9</p>"
            ,"repeat"     : "include_model_3"
        }
	,{
            "role"       : "input"
            ,"id"         : "sigma_r_3"
            ,"label"      : "Interface roughness [&Aring;]"
            ,"type"       : "float"
            ,"size"       : 40
            ,"step"       : 1
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 15.0
            ,"help"       : "<p>Interface roughness, for non-sharp edges between subunits. </p> See Skar-Gislinge et al, PhysChemChemPhys 2011: Small-angle scattering from phospholipid nanodiscs: derivation and refinement of a molecular constrained analytical model form factor. </p><p> Decreasing scattering at high q, by I(q) = I(q)*exp(-(q*sigma_r)^2/2)</p><p>Min: 0.0 (no roughness), max: 15.0</p>"
            ,"repeat"     : "include_model_3"
        }
#################################################################################################################
## MODEL 4 ######################################################################################################
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "include_model_4"
            ,"label"      : "<hr> Calculate scattering for Model 4"
            ,"type"       : "checkbox"
            ,"checked"    : "false"
            ,"help"       : "<p>Calculate scattering for Model 4 - for comparison with other models.</p>"
            ,"colspan"    : 17
            ,"repeater"   : "true"
            ,"hider"      : "true"
        }
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "name_4"
            ,"label"      : "Name of Model 4"
            ,"type"       : "text"
            ,"default"    : "Name 4"
            ,"size"       : 17
            ,"help"       : "<p>Name of Model 4 </p><p>The model consists of one or more subunits</p></p><p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"
	    ,"repeat"     : "include_model_4"
        }
	,{
            "role"       : "input"
            ,"id"         : "exclude_overlap_4"
            ,"label"      : "Exclude overlap regions"
            ,"type"       : "checkbox"
            ,"checked"    : "true"
            ,"help"       : "<p>Exclude overlap regions.</p><p>If there is overlap with subunits higher up in the list, the points in the overlap region will be omitted.</p>"
            ,"repeat"     : "include_model_4"
        }
	,{
            "role"       : "input"
            ,"id"         : "subunit_count_4"
            ,"label"      : "Number of subunits"
            ,"type"       : "integer"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 15
            ,"help"       : "Enter the number of subunits, up to 15. Consider increasing the number of points for complex shapes."
	    ,"tableize"   : "true"
	    ,"repeat"     : "include_model_4"
	    ,"repeater"   : "true"
        }
#################################################################################################################
        ,{"role": "input","id": "subunit_type_4","label": "&nbsp;subunit type","type": "listbox","values": "Sphere~sphere~Ellipsoid (Tri-axial)~ellipsoid~Cylinder~cylinder~Disc~disc~Cube~cube~Cuboid~cuboid~Hollow sphere~hollow_sphere~Hollow cube~hollow_cube~Cylindrical ring~cyl_ring~Discoidal ring~disc_ring","norow": "true","size": 30,"default": "sphere","repeat": "subunit_count_4","help": "<p>Subunits and parameters (in Angstrom):</p><p>Sphere; a: Radius, b,c: no effect</p><p> Ellipsoid; a, b, c: semiaxes</p><p> Cylinder/Disc; a, b: semiaxes, c: length</p><p>Cube; a: side length, b,c: no effect</p><p>Cuboid; a: width, b: depth, c: height</p><p>Hollow sphere; a: outer radius, b: inner radius, c: no effect</p><p>Hollow cube; a: outer side length, b: inner side length, c: no effect </p><p>Cylindrical/discoidal ring; a: outer radius, b: inner radius, c: length </p><p>Cylinder and Disc is the same model, but differ in default parameters. Same is true for Discoidal and Cylindrical ring.</p><p>Subunits can have different excess scattering length density (&Delta;SLD).</p>"}
        ,{"role": "input","id": "a_4","label": "&nbsp;a","type": "float","min": "0","max": "9999999","default": 50,"norow": "true","required" : "true","repeat": "subunit_count_4","help": "<p>Subunit dimension a</p><p>Sphere: radius</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: side length</p><p>Cuboid: width</p><p>Hollow sphere: outer radius</p><p>Hollow cube: outer side length</p><p>Cylindrical/discoidal ring: outer radius </p>"}
        ,{"role": "input","id": "b_4","label": "&nbsp;b ","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_4","help": "<p>Subunit dimension b</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: semiaxis</p><p>Cube: no effect</p><p>Cuboid: depth</p><p>Hollow sphere: inner radius</p><p>Hollow cube: inner side length</p><p>Cylindrical/discoidal ring: inner radius </p>"}
        ,{"role": "input","id": "c_4","label": "&nbsp;c","type": "float","min": "0","max": "9999999","norow": "true","repeat": "subunit_count_4","help": "<p>Subunit dimension c</p><p>Sphere: no effect</p><p> Ellipsoid: semiaxis </p><p> Cylinder/Disc: length</p><p>Cube: no effect</p><p>Cuboid: height</p><p>Hollow sphere: no effect </p><p>Hollow cube: no effect</p><p>Cylindrical/discoidal ring: length </p>"}
        ,{"role": "input","id": "p_4","label": "&nbsp;&Delta;SLD","type": "float","min": "-999999","max": "9999999","default": 1,"norow": "true","repeat": "subunit_count_4","help": "Excess scattering length density (contrast) of subunit"}
        ,{"role": "input","id": "x_4","label": "&nbsp;x_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_4","help": "center of mass x position of subunit"}
        ,{"role": "input","id": "y_4","label": "&nbsp;y_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_4","help": "center of mass y position of subunit"}
        ,{"role": "input","id": "z_4","label": "&nbsp;z_com","type": "float","min": "-999999","max": "9999999","default": 0.0,"norow": "true","repeat": "subunit_count_4","help": "center of mass z position of subunit"}	
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "polydispersity_4"
            ,"label"      : "Relative polydispersity"
            ,"type"       : "float"
            ,"step"       : 0.05
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 0.3
            ,"help"       : "Relative polydispersity. Min: 0.0 (monodisperse), max: 0.3."
            ,"repeat"     : "include_model_4"
        }
        ,{
            "role"       : "input"
            ,"id"         : "S_4"
            ,"label"      : "Structure factor"
            ,"type"       : "listbox"
            ,"values"     : "None~None~Hard-sphere~HS~Aggregate~Aggr"
            ,"default"    : "None"
            ,"repeater"   : "true"
            ,"help"       : "<p>Select structure factor from the list (default: None)</p><p>Hard-sphere: Hard-sphere structure factor, repulsion in concentrated samples, see Ref [1]</p><p>Aggregate: Aggregate structure factor, 2-dimensional fractal aggregates, see Ref [2]</p><p>[1] Kotlarchyk and Chen, J Chem Phys 1984: Analysis of small angle neutron scattering spectra from polydisperse interacting colloids.</p><p>[2] Larsen, Pedersen and Arleth, J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates.</p>"
            ,"repeat"     : "include_model_4"
        }
#        ,{
#            "role"       : "input"
#            ,"id"         : "eta_4"
#            ,"label"      : "Volume fraction"
#            ,"type"       : "float"
#            ,"step"       : 0.1
#            ,"default"    : 0.2
#            ,"min"        : 0.0
#            ,"max"        : 0.9
#            ,"repeat"     : "S_4:HS"
#            ,"help"       : "<p>Volume fraction in hard-sphere structure factor, S(q). For high-conc samples.</p><p>Applied to the scattering, I(q), but not to the p(r), which is for the monodisperse model.</p><p>Min: 0.0 (no structure factor), max: 0.9.</p>"
#        }
        ,{
            "role"       : "input"
            ,"id"         : "r_hs_4"
            ,"label"      : "Hard-sphere radius"
            ,"type"       : "float"
            ,"step"       : 5
            ,"default"    : 50
            ,"min"        : 0.0
            ,"max"        : 1000
            ,"repeat"     : "S_4:HS"
            ,"help"       : "<p>Hard-sphere interaction radius - for high concentration samples.</p><p> Used in hard sphere structure factor, S(q)</p><p>Min: 0.0.</p><p>Only relevant if Volume fraction > 0</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "frac_4"
            ,"label"      : "Fraction of aggregates"
            ,"type"       : "float"
            ,"step"       : 0.1
            ,"default"    : 0.1
            ,"min"        : 0.0
            ,"max"        : 1.0
            ,"repeat"     : "S_4:Aggr"
            ,"help"       : "<p>Fraction of particles that are in aggregated form. </p><p>Aggregates are assumed to form fractal aggregates, included in scattering (not in p(r)) via structure factor S2(q) from Ref:</p><p>Larsen, Pedersen and Arleth (2020). J Appl cryst 2020: Assessment of structure factors for analysis of small-angle scattering data from desired or undesired aggregates</p><p>Min: 0.0 (no aggregates). Max: 1.0 (all particles are aggregated).</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "R_eff_4"
            ,"label"      : "Effective radius"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 50
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Effective radius of each particle in aggregate (not of whole aggregate). </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_4:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "N_aggr_4"
            ,"label"      : "Particles per aggregate"
            ,"type"       : "float"
            ,"step"       : 1
            ,"default"    : 80
            ,"min"        : 0
            ,"max"        : 1000
            ,"help"       : "<p>Number of particles per aggregate. </p><p>Only relevant if Fraction of aggregates > 0.</p><p>Min: 0. Max: 1000.</p>"
            ,"repeat"     : "S_4:Aggr"
        }
        ,{
            "role"       : "input"
            ,"id"         : "conc_4"
            ,"label"      : "Volume fraction (conc)"
            ,"type"       : "float"
            ,"step"       : 0.02
            ,"default"    : 0.02
            ,"min"        : 0.0
            ,"max"        : 0.9
            ,"help"       : "<p>Volume fraction (concentration):</p><p>how much of the sample volume is occupied by the particles - scales the intensity and affects the noise in data.</p><p>The volume fraction also affects the scattering via the hard-sphere structure factor, if this is enabled.</p><p>Min: 0.0, max: 0.9</p>"
            ,"repeat"     : "include_model_4"
        }
	,{
            "role"       : "input"
            ,"id"         : "sigma_r_4"
            ,"label"      : "Interface roughness [&Aring;]"
            ,"type"       : "float"
            ,"size"       : 40
            ,"step"       : 1
            ,"default"    : 0.0
            ,"min"        : 0.0
            ,"max"        : 15.0
            ,"help"       : "<p>Interface roughness, for non-sharp edges between subunits. </p> See Skar-Gislinge et al, PhysChemChemPhys 2011: Small-angle scattering from phospholipid nanodiscs: derivation and refinement of a molecular constrained analytical model form factor. </p><p> Decreasing scattering at high q, by I(q) = I(q)*exp(-(q*sigma_r)^2/2)</p><p>Min: 0.0 (no roughness), max: 15.0</p>"
            ,"repeat"     : "include_model_4"
        }
#################################################################################################################
## PLOTTING OPTIONS #############################################################################################
#################################################################################################################
        ,{
            "role"       : "input"
            ,"id"         : "hrinput_3"
            ,"label"      : "<hr> Plotting options <hr>"
            ,"type"       : "label"
            ,"colspan"    : 17
        }
        ,{
            "role"       : "input"
            ,"id"         : "xscale_lin"
            ,"label"      : "Linear q scale (default: logarithmic)"
            ,"type"       : "checkbox"
            ,"checked"    : "false"
            ,"help"       : "<p>Plot resulting scattering on linear q-scale (instead of logarithmic).</p><p> Not interactice, so press Submit again to change the x scales.</p>"
        }
	,{
            "role"       : "input"
            ,"id"         : "high_res"
            ,"label"      : "High resolution"
            ,"type"       : "checkbox"
            ,"checked"    : "false"
            ,"help"       : "<p>Plots in high resolution (600 DPI png).</p><p> Not interactice, so press Submit again to apply the changes.</p>"
        }
        ,{
            "role"       : "input"
            ,"id"         : "scale1"
            ,"label"      : "Scale simulated intensity from Model 1 by:"
            ,"type"       : "float"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 100000
            ,"step"       : 1
            ,"help"       : "<p>Scale the simulated scattering (with noise) from Model 1 by a factor (default: 1, no scaling).</p><p> Not interactive, so press Submit again to apply changes.</p>"
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "input"
            ,"id"         : "scale2"
            ,"label"      : "Scale simulated intensity from Model 2 by:"
            ,"type"       : "float"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 100000
            ,"step"       : 1
            ,"help"       : "<p>Scale the simulated scattering (with noise) from Model 2 by a factor (default: 1, no scaling).</p><p> Not interactive, so press Submit again to apply changes.</p>"
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "input"
            ,"id"         : "scale3"
            ,"label"      : "Scale simulated intensity from Model 3 by:"
            ,"type"       : "float"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 100000
            ,"step"       : 1
            ,"help"       : "<p>Scale the simulated scattering (with noise) from Model 3 by a factor (default: 1, no scaling).</p><p> Not interactive, so press Submit again to apply changes.</p>"
            ,"show"       : "include_model_3"
        }
	,{
            "role"       : "input"
            ,"id"         : "scale4"
            ,"label"      : "Scale simulated intensity from Model 4 by:"
            ,"type"       : "float"
            ,"default"    : 1
            ,"min"        : 1
            ,"max"        : 100000
            ,"step"       : 1
            ,"help"       : "<p>Scale the simulated scattering (with noise) from Model 4 by a factor (default: 1, no scaling).</p><p> Not interactive, so press Submit again to apply changes.</p>"
            ,"show"       : "include_model_4"
        }
#################################################################################################################
## OUTPUT #######################################################################################################
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "hroutput"
            ,"label"      : "<hr> Output, Model 1 <hr>"
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"show"       : "include_model_1"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "pr_1"
            ,"label"      : "p(r)"
            ,"type"       : "file"
            ,"help"       : "The calculated p(r)"
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Iq_1"
            ,"label"      : "Intensity, calculated (no errors)"
            ,"type"       : "file"
            ,"help"       : "The calculated intensity, I(q)"
            ,"show"       : "include_model_1"
        }
       ,{
            "role"       : "output"
            ,"id"         : "Isim_1"
            ,"label"      : "Intensity, simulated (with errors)"
            ,"type"       : "file"
            ,"help"       : "<p>Simulated intensity, format: q, I(q), sigma.</p><p>sigma simulated using Sedlak et al (https://doi.org/10.1107/S1600576717003077)</p>"
            ,"show"       : "include_model_1"
        }
	,{
            "role"       : "output"
            ,"id"         : "pdb_1"
            ,"label"      : "PDB file with model (open e.g. with PyMOL or <a target=_blank href=https://www.rcsb.org/3d-view>PDB-3Dviewer</a>)"
            ,"type"       : "file"
            ,"help"       : "<p>PDB file of model, for visualization, e.g. in PyMOL or with online 3Dviewer.</p><p> All points represented as dummy Carbon beads (positive SLD), dummy Oxygen beads (negative SLD) or dummy Hydrogen beads (zero SLD).</p><p> WARNING: The model will not give correct scattering if used as input in, e.g., CRYSOL, PEPSI-SAXS, FOXS, CAPP, etc - it is only for vizualization</p>."
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "output"
            ,"id"         : "zip_1"
            ,"label"      : "Results zipped"
            ,"type"       : "file"
            ,"help"       : "Results packaged in a zip file"
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Dmax_1"
            ,"label"      : "Dmax, Model 1 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Maximum distance in Model 1, in Angstrom"
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Rg_1"
            ,"label"      : "Rg, Model 1 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Radius of gyration of Model 1, in Angstrom"
            ,"show"       : "include_model_1"
        }
#################################################################################################################
	,{
            "role"       : "output"
            ,"id"         : "hroutput_2"
            ,"label"      : "<hr> Output, Model 2 <hr>"
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"show"       : "include_model_2"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "pr_2"
            ,"label"      : "p(r)"
            ,"type"       : "file"
            ,"help"       : "The calculated p(r)"
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Iq_2"
            ,"label"      : "Intensity, calculated (no errors)"
            ,"type"       : "file"
            ,"help"       : "The calculated intensity, I(q)"
            ,"show"       : "include_model_2"
        }
       ,{
            "role"       : "output"
            ,"id"         : "Isim_2"
            ,"label"      : "Intensity, simulated (with errors)"
            ,"type"       : "file"
            ,"help"       : "<p>Simulated intensity, format: q, I(q), sigma.</p><p>sigma simulated using Sedlak et al (https://doi.org/10.1107/S1600576717003077)</p>"
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "output"
            ,"id"         : "pdb_2"
            ,"label"      : "PDB file with model (open e.g. with PyMOL or <a target=_blank href=https://www.rcsb.org/3d-view>PDB-3Dviewer</a>)"
            ,"type"       : "file"
            ,"help"       : "<p>PDB file of model, for visualization, e.g. in PyMOL or with online 3Dviewer.</p><p> All points represented as dummy Carbon beads (positive SLD), dummy Oxygen beads (negative SLD) or dummy Hydrogen beads (zero SLD).</p><p> WARNING: The model will not give correct scattering if used as input in, e.g., CRYSOL, PEPSI-SAXS, FOXS, CAPP, etc - it is only for vizualization</p>."
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "output"
            ,"id"         : "zip_2"
            ,"label"      : "Results zipped"
            ,"type"       : "file"
            ,"help"       : "Results packaged in a zip file"
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Dmax_2"
            ,"label"      : "Dmax, Model 2 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Maximum distance in Model 2"
            ,"show"       : "include_model_2"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Rg_2"
            ,"label"      : "Rg, Model 2 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Radius of gyration of Model 2"
            ,"show"       : "include_model_2"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "hroutput_3"
            ,"label"      : "<hr> Output, Model 3 <hr>"
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"show"       : "include_model_3"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "pr_3"
            ,"label"      : "p(r)"
            ,"type"       : "file"
            ,"help"       : "The calculated p(r)"
            ,"show"       : "include_model_3"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Iq_3"
            ,"label"      : "Intensity, calculated (no errors)"
            ,"type"       : "file"
            ,"help"       : "The calculated intensity, I(q)"
            ,"show"       : "include_model_3"
        }
       ,{
            "role"       : "output"
            ,"id"         : "Isim_3"
            ,"label"      : "Intensity, simulated (with errors)"
            ,"type"       : "file"
            ,"help"       : "<p>Simulated intensity, format: q, I(q), sigma.</p><p>sigma simulated using Sedlak et al (https://doi.org/10.1107/S1600576717003077)</p>"
            ,"show"       : "include_model_3"
        }
        ,{
            "role"       : "output"
            ,"id"         : "pdb_3"
            ,"label"      : "PDB file with model (open e.g. with PyMOL or <a target=_blank href=https://www.rcsb.org/3d-view>PDB-3Dviewer</a>)"
            ,"type"       : "file"
            ,"help"       : "<p>PDB file of model, for visualization, e.g. in PyMOL or with online 3Dviewer.</p><p> All points represented as dummy Carbon beads (positive SLD), dummy Oxygen beads (negative SLD) or dummy Hydrogen beads (zero SLD).</p><p> WARNING: The model will not give correct scattering if used as input in, e.g., CRYSOL, PEPSI-SAXS, FOXS, CAPP, etc - it is only for vizualization</p>."
            ,"show"       : "include_model_3"
        }
        ,{
            "role"       : "output"
            ,"id"         : "zip_3"
            ,"label"      : "Results zipped"
            ,"type"       : "file"
            ,"help"       : "Results packaged in a zip file"
            ,"show"       : "include_model_3"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Dmax_3"
            ,"label"      : "Dmax, Model 3 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Maximum distance in Model 3"
            ,"show"       : "include_model_3"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Rg_3"
            ,"label"      : "Rg, Model 3 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Radius of gyration of Model 3"
            ,"show"       : "include_model_3"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "hroutput_4"
            ,"label"      : "<hr> Output, Model 4 <hr>"
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"show"       : "include_model_4"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "pr_4"
            ,"label"      : "p(r)"
            ,"type"       : "file"
            ,"help"       : "The calculated p(r)"
            ,"show"       : "include_model_4"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Iq_4"
            ,"label"      : "Intensity, calculated (no errors)"
            ,"type"       : "file"
            ,"help"       : "The calculated intensity, I(q)"
            ,"show"       : "include_model_4"
        }
       ,{
            "role"       : "output"
            ,"id"         : "Isim_4"
            ,"label"      : "Intensity, simulated (with errors)"
            ,"type"       : "file"
            ,"help"       : "<p>Simulated intensity, format: q, I(q), sigma.</p><p>sigma simulated using Sedlak et al (https://doi.org/10.1107/S1600576717003077)</p>"
            ,"show"       : "include_model_4"
        }
        ,{
            "role"       : "output"
            ,"id"         : "pdb_4"
            ,"label"      : "PDB file with model (open e.g. with PyMOL or <a target=_blank href=https://www.rcsb.org/3d-view>PDB-3Dviewer</a>)"
            ,"type"       : "file"
            ,"help"       : "<p>PDB file of model, for visualization, e.g. in PyMOL or with online 3Dviewer.</p><p> All points represented as dummy Carbon beads (positive SLD), dummy Oxygen beads (negative SLD) or dummy Hydrogen beads (zero SLD).</p><p> WARNING: The model will not give correct scattering if used as input in, e.g., CRYSOL, PEPSI-SAXS, FOXS, CAPP, etc - it is only for vizualization</p>."
            ,"show"       : "include_model_4"
        }
        ,{
            "role"       : "output"
            ,"id"         : "zip_4"
            ,"label"      : "Results zipped"
            ,"type"       : "file"
            ,"help"       : "Results packaged in a zip file"
            ,"show"       : "include_model_4"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Dmax_4"
            ,"label"      : "Dmax, Model 4 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Maximum distance in Model 4"
            ,"show"       : "include_model_4"
        }
        ,{
            "role"       : "output"
            ,"id"         : "Rg_4"
            ,"label"      : "Rg, Model 4 [&Aring;]"
            ,"type"       : "text"
            ,"help"       : "Radius of gyration of Model 4"
	    ,"repeat"     : "include_model_4"
            ,"show"       : "include_model_4"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "label_fig"
            ,"label"      : "<p><hr> Plots of model, p(r) and scattering <hr></p><p>calculated p(r), calculated I(q), and simulated I(q) - with noise. </p>" 
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"help"       : "<p>Upper panel: calculated p(r), calculated I(q), and simulated I(q) - with noise. </p>"
        }
        ,{
            "role"       : "output"
            ,"id"         : "fig"
            ,"label"      : ""
            ,"type"       : "image"
            ,"width"      : "80%"
        }
#################################################################################################################
        ,{
            "role"       : "output"
            ,"id"         : "label_2D"
            ,"label"      : "<p>2D projections of model(s) (red/blue/yellow/green dots have positive &Delta;SLD, black have negative &Delta;SLD and grey have zero &Delta;SLD).</p>"
            ,"type"       : "label"
            ,"colspan"    : 2
            ,"help"       : "<p>2D projections of model(s) (red/blue/yellow/green dots have positive &Delta;SLD, black have negative &Delta;SLD and grey have zero &Delta;SLD).</p>"
        }
       ,{
            "role"       : "output"
            ,"id"         : "points_1"
            ,"label"      : ""
            ,"type"       : "image"
            ,"width"      : "80%"
        }
	,{
            "role"       : "output"
            ,"id"         : "points_2"
            ,"label"      : ""
            ,"type"       : "image"
            ,"width"      : "80%"
        }
	,{
            "role"       : "output"
            ,"id"         : "points_3"
            ,"label"      : ""
            ,"type"       : "image"
            ,"width"      : "80%"
        }
	,{
            "role"       : "output"
            ,"id"         : "points_4"
            ,"label"      : ""
            ,"type"       : "image"
            ,"width"      : "80%"
        }
	,{
            "role"       : "output"
            ,"id"         : "pdb_jmol_1"
            ,"label"      : "3D vizualisation of Model 1 (right click for options)"
            ,"type"       : "atomicstructure"
            ,"height"     : "350"
            ,"width"      : "900"
            ,"jsmoladd"   : "spin on; wireframe off"
            ,"show"       : "include_model_1"
        }
        ,{
            "role"       : "output"
            ,"id"         : "pdb_jmol_2"
            ,"label"      : "3D vizualisation of Model 2 (right click for options)"
            ,"type"       : "atomicstructure"
            ,"height"     : "350"
            ,"width"      : "900"
            ,"jsmoladd"   : "spin on; wireframe off"
            ,"show"       : "include_model_2"
        }
	,{
            "role"       : "output"
            ,"id"         : "pdb_jmol_3"
            ,"label"      : "3D vizualisation of Model 3 (right click for options)"
            ,"type"       : "atomicstructure"
            ,"height"     : "350"
            ,"width"      : "900"
            ,"jsmoladd"   : "spin on; wireframe off"
            ,"show"       : "include_model_3"
        }
	,{
            "role"       : "output"
            ,"id"         : "pdb_jmol_4"
            ,"label"      : "3D vizualisation of Model 4 (right click for options)"
            ,"type"       : "atomicstructure"
            ,"height"     : "350"
            ,"width"      : "900"
            ,"jsmoladd"   : "spin on; wireframe off; cpk"
            ,"show"       : "include_model_4"
        }
    ]
}
